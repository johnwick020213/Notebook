## **什么是 TCP 协议？**

TCP 协议是 <span style="color:#FF0000;"> **面向连接的** </span>，**<span style="color:#FF0000;"> 可靠的 </span>**，**<span style="color:#FF0000;">全双工</span>**，<span style="color:#FF0000;"> **基于字节流** </span> 的传输层通信协议。

- **<span style="color:#0000FF;"> 面向连接 </span>**：一定是一对一才能连接，不能像 UDP 那样一对多。
- **<span style="color:#0000FF;"> 可靠的 </span>**：无论网络链路层的链路如何变化，TCP 都能保证一个报文发送到接收端。
- **<span style="color:#0000FF;"> 基于字节流 </span>**：
  - 用户的一条信息通过 TCP 协议传输时，可能会被操作系统分为多个 TCP 报文。
  - 如果接收方不知道消息边界，是无法读出一个有效的消息。
  - 并且 TCP 报文是有序的，当前一个 TCP 报文没有收到时，即使收到了后面的报文，也不会给应用层处理。
  - 同时，对于重复的 TCP 报文也会自动丢弃。

## **TCP 与 UDP 区别：**

1. **<span style="color:#0000FF;"> 连接 </span>**
   - TCP 是面向连接的传输层协议，传输数据前要建立连接
   - UDP 是不需要连接，即刻传输数据
2. **<span style="color:#0000FF;"> 服务对象 </span>**
   - TCP 是一对一的两点服务。
   - UDP 是一对一，一对多，多对多的交互通信
3. **<span style="color:#0000FF;"> 可靠性 </span>**
   - TCP 是可靠交付，数据可以无差错，不丢失，不重复，按序到达。
   - UDP 是尽可能交付，不保证可靠交付数据。
4. **<span style="color:#0000FF;"> 拥塞控制，流量控制 </span>**
   - TCP有拥塞控制，流量控制，保证数据传输的安全性。
   - UDP则没有，即使网络十分堵塞，也不会影响UDP的发送速率。
5. **<span style="color:#0000FF;"> 首部开销 </span>**
   - TCP首部较长，会有一定的开销
   - UDP首部固定8个字节，并且固定不变，开销较小。
6. <span style="color:#0000FF; font-weight:bold;">传输方式</span>
   - TCP是流式传输，没有边界，但保证顺序和可靠。
   - UDP是一个包一个包的发送，是有边界的，但可能会丢包和乱序。

7. <span style="color:#0000FF; font-weight:bold;">分片不同</span>
   - TCP数据如果大于MSS大小，则会在传输层进行分片，目标主句收到后，也会同样在传输层组装TCP数据包。如果中途丢失一个分片，只需要传输丢失分片。
   - UDP的数据大小大于MTU大小，则会在IP层进行分片，目标主机收到后，在IP层组装完数据，接着再传给传输层。


## 为什么TCP要建立三次握手？

- 三次握手可以避免重复的历史连接初始化。
- 三次握手可以同步双方的初始序列号。
- 三次握手可以避免资源的浪费。

## 为什么TCP断开要四次挥手？

- 客户端与服务端断开时，客户端要发送FIN信号，进入FIN_WAIT1,请求断开。
- 然后服务端在收到FIN的信号后，给客户端发送一条ACK报文，进入CLOSED_WAIT，处理客户端的数据。客户端进入FIN_WAIT2。
- 处理完数据后，再向客户端发送FIN信号，进入LASR_ACK,等待客户端确认。
- 客户端在收到FIN信号后，给服务端发送ACK报文确认，进入TIME_WAIT，确保服务端收到ACK报文。
